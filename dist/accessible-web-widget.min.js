/*!
 * AccessibleWeb Widget v1.0.0
 * https://github.com/ifrederico/accessible-web-widget
 * 
 * Copyright (c) 2024 ifrederico
 * Released under the MIT License
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND.
 * See DISCLAIMER.md for important legal information.
 * This widget does not guarantee accessibility compliance.
 */


class AccessibleWebWidget{constructor(t={}){this.widgetTheme={primaryColor:"#886f60",primaryColorLight:"#b6a89e",primaryColorDark:"#5f4e43",backgroundColor:"#f5f7fa",textColor:"#222222",textColorInverted:"#ffffff",buttonSize:"34px",cardBackground:"#ffffff",borderColor:"#d1d5db",focusRingColor:"#b6a89e",hoverColor:"#b6a89e",activeColor:"#5f4e43",successColor:"#2e7d32",errorColor:"#c62828",warningColor:"#f57c00",headerHeight:"54px",borderRadius:"8px",buttonBorderRadius:"0.4rem",menuPosition:"right",zIndex:1e5,focusBorderWidth:"3px",focusOutlineOffset:"2px"},this.widgetIcons={accessibility:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"><path d="M480-720q-33 0-56.5-23.5T400-800q0-33 23.5-56.5T480-880q33 0 56.5 23.5T560-800q0 33-23.5 56.5T480-720ZM360-80v-520q-60-5-122-15t-118-25l20-80q78 21 166 30.5t174 9.5q86 0 174-9.5T820-720l20 80q-56 15-118 25t-122 15v520h-80v-240h-80v240h-80Z"/></svg>',largePointer:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"><path d="m320-410 79-110h170L320-716v306ZM551-80 406-392 240-160v-720l560 440H516l144 309-109 51ZM399-520Z"/></svg>',pauseMotion:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="m791-55-91-91q-49 32-104.5 49T480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 17-115.5T146-700l-91-91 57-57 736 736-57 57ZM480-160q43 0 83.5-11t78.5-33L204-642q-22 38-33 78.5T160-480q0 133 93.5 226.5T480-160Zm334-100-58-58q22-38 33-78.5t11-83.5q0-133-93.5-226.5T480-800q-43 0-83.5 11T318-756l-58-58q49-32 104.5-49T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 60-17 115.5T814-260ZM537-537ZM423-423Z"/></svg>',readingAid:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M320-80v-440l-80-120v-240h480v240l-80 120v440H320Zm160-260q-25 0-42.5-17.5T420-400q0-25 17.5-42.5T480-460q25 0 42.5 17.5T540-400q0 25-17.5 42.5T480-340ZM320-760h320v-40H320v40Zm320 80H320v16l80 120v384h160v-384l80-120v-16ZM480-480Z"/></svg>',boldText:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M272-200v-560h221q65 0 120 40t55 111q0 51-23 78.5T602-491q25 11 55.5 41t30.5 90q0 89-65 124.5T501-200H272Zm121-112h104q48 0 58.5-24.5T566-372q0-11-10.5-35.5T494-432H393v120Zm0-228h93q33 0 48-17t15-38q0-24-17-39t-44-15h-95v109Z"/></svg>',lineSpacing:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M240-160 80-320l56-56 64 62v-332l-64 62-56-56 160-160 160 160-56 56-64-62v332l64-62 56 56-160 160Zm240-40v-80h400v80H480Zm0-240v-80h400v80H480Zm0-240v-80h400v80H480Z"/></svg>',letterSpacing:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M320-80 160-240l160-160 57 56-64 64h334l-63-64 56-56 160 160L640-80l-57-56 64-64H313l63 64-56 56ZM200-480v-400h80v400h-80Zm240 0v-400h80v400h-80Zm240 0v-400h80v400h-80Z"/></svg>',dyslexiaFont:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="m131-252 165-440h79l165 440h-76l-39-112H247l-40 112h-76Zm139-176h131l-64-182h-4l-63 182Zm395 186q-51 0-81-27.5T554-342q0-44 34.5-72.5T677-443q23 0 45 4t38 11v-12q0-29-20.5-47T685-505q-23 0-42 9.5T610-468l-47-35q24-29 54.5-43t68.5-14q69 0 103 32.5t34 97.5v178h-63v-37h-4q-14 23-38 35t-53 12Zm12-54q35 0 59.5-24t24.5-56q-14-8-33.5-12.5T689-393q-32 0-50 14t-18 37q0 20 16 33t40 13Z"/></svg>',highlightLinks:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M440-280H280q-83 0-141.5-58.5T80-480q0-83 58.5-141.5T280-680h160v80H280q-50 0-85 35t-35 85q0 50 35 85t85 35h160v80ZM320-440v-80h320v80H320Zm200 160v-80h160q50 0 85-35t35-85q0-50-35-85t-85-35H520v-80h160q83 0 141.5 58.5T880-480q0 83-58.5 141.5T680-280H520Z"/></svg>',highlightTitle:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M320-280q17 0 28.5-11.5T360-320q0-17-11.5-28.5T320-360q-17 0-28.5 11.5T280-320q0 17 11.5 28.5T320-280Zm0-160q17 0 28.5-11.5T360-480q0-17-11.5-28.5T320-520q-17 0-28.5 11.5T280-480q0 17 11.5 28.5T320-440Zm0-160q17 0 28.5-11.5T360-640q0-17-11.5-28.5T320-680q-17 0-28.5 11.5T280-640q0 17 11.5 28.5T320-600Zm120 320h240v-80H440v80Zm0-160h240v-80H440v80Zm0-160h240v-80H440v80ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z"/></svg>',darkContrast:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M484-80q-84 0-157.5-32t-128-86.5Q144-253 112-326.5T80-484q0-146 93-257.5T410-880q-18 99 11 193.5T521-521q71 71 165.5 100T880-410q-26 144-138 237T484-80Zm0-80q88 0 163-44t118-121q-86-8-163-43.5T464-465q-61-61-97-138t-43-163q-77 43-120.5 118.5T160-484q0 135 94.5 229.5T484-160Zm-20-305Z"/></svg>',lightContrast:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M440-800v-120h80v120h-80Zm0 760v-120h80v120h-80Zm360-400v-80h120v80H800Zm-760 0v-80h120v80H40Zm708-252-56-56 70-72 58 58-72 70ZM198-140l-58-58 72-70 56 56-70 72Zm564 0-70-72 56-56 72 70-58 58ZM212-692l-72-70 58-58 70 72-56 56Zm268 452q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm0-80q67 0 113.5-46.5T640-480q0-67-46.5-113.5T480-640q-67 0-113.5 46.5T320-480q0 67 46.5 113.5T480-320Zm0-160Z"/></svg>',invertColors:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-64-24.5-122.5T706-706L254-254q45 45 103.5 69.5T480-160Zm0-160v-60h200v60H480ZM320-500h60v-80h80v-60h-80v-80h-60v80h-80v60h80v80Z"/></svg>',lowSaturation:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M480-120q-133 0-226.5-92T160-436q0-65 25-121.5T254-658l226-222 226 222q44 44 69 100.5T800-436q0 132-93.5 224T480-120ZM242-400h474q12-72-13.5-123T650-600L480-768 310-600q-27 26-53 77t-15 123Z"/></svg>',highSaturation:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 32.5-156t88-127Q256-817 330-848.5T488-880q80 0 151 27.5t124.5 76q53.5 48.5 85 115T880-518q0 115-70 176.5T640-280h-74q-9 0-12.5 5t-3.5 11q0 12 15 34.5t15 51.5q0 50-27.5 74T480-80Zm0-400Zm-220 40q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120-160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm200 0q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120 160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17ZM480-160q9 0 14.5-5t5.5-13q0-14-15-33t-15-57q0-42 29-67t71-25h70q66 0 113-38.5T800-518q0-121-92.5-201.5T488-800q-136 0-232 93t-96 227q0 133 93.5 226.5T480-160Z"/></svg>',monochrome:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm40-83q119-15 199.5-104.5T800-480q0-123-80.5-212.5T520-797v634Z"/></svg>',reset:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M440-122q-121-15-200.5-105.5T160-440q0-66 26-126.5T260-672l57 57q-38 34-57.5 79T240-440q0 88 56 155.5T440-202v80Zm80 0v-80q87-16 143.5-83T720-440q0-100-70-170t-170-70h-3l44 44-56 56-140-140 140-140 56 56-44 44h3q134 0 227 93t93 227q0 121-79.5 211.5T520-122Z"/></svg>',close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>',increase:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2Z"/></svg>',decrease:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 13H5v-2h14v2Z"/></svg>',arrowBack:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M400-80 0-480l400-400 71 71-329 329 329 329-71 71Z"/></svg>',adjustFontSize:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 4v3h5v12h3V7h5V4H2m19 5h-9v3h3v7h3v-7h3V9Z"/></svg>',language:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-155.5t86-127Q252-817 325-848.5T480-880q83 0 155.5 31.5t127 86q54.5 54.5 86 127T880-480q0 82-31.5 155t-86 127.5q-54.5 54.5-127 86T480-80Zm0-82q26-36 45-75t31-83H404q12 44 31 83t45 75Zm-104-16q-18-33-31.5-68.5T322-320H204q29 50 72.5 87t99.5 55Zm208 0q56-18 99.5-55t72.5-87H638q-9 38-22.5 73.5T584-178ZM170-400h136q-3-20-4.5-39.5T300-480q0-21 1.5-40.5T306-560H170q-5 20-7.5 39.5T160-480q0 21 2.5 40.5T170-400Zm216 0h188q3-20 4.5-39.5T580-480q0-21-1.5-40.5T574-560H386q-3 20-4.5 39.5T380-480q0 21 1.5 40.5T386-400Zm268 0h136q5-20 7.5-39.5T800-480q0-21-2.5-40.5T790-560H654q3 20 4.5 39.5T660-480q0 21-1.5 40.5T654-400Zm-16-240h118q-29-50-72.5-87T584-782q18 33 31.5 68.5T638-640Zm-234 0h152q-12-44-31-83t-45-75q-26 36-45 75t-31 83Zm-200 0h118q9-38 22.5-73.5T376-782q-56 18-99.5 55T204-640Z"/></svg>',hideImages:'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="m840-234-80-80v-446H314l-80-80h526q33 0 56.5 23.5T840-760v526ZM792-56l-64-64H200q-33 0-56.5-23.5T120-200v-528l-64-64 56-56 736 736-56 56ZM240-280l120-160 90 120 33-44-283-283v447h447l-80-80H240Zm297-257ZM424-424Z"/></svg>'},this.targetSelectors={ALL:["","*:not(.material-icons,.acc-menu,.acc-menu *)"],LINKS:["a[href]"],HEADERS:["h1","h2","h3","h4","h5","h6",".wsite-headline",".wsite-content-title"],TEXT:["h1","h2","h3","h4","h5","h6",".wsite-headline",".wsite-content-title","img","p","i","svg","a","button:not(.acc-btn)","label","li","ol"]},this.visualFilters={"dark-contrast":{styles:{filter:"contrast(150%) brightness(0.8)"},selector:"html:not(.acc-menu, .acc-widget)"},"light-contrast":{styles:{filter:"contrast(125%) brightness(1.2)"},selector:"html:not(.acc-menu, .acc-widget)"},"invert-colors":{styles:{filter:"invert(100%)"},selector:"html:not(.acc-menu, .acc-widget)"},"low-saturation":{styles:{filter:"saturate(50%)"},selector:"html:not(.acc-menu, .acc-widget)"},monochrome:{styles:{filter:"grayscale(100%)"},selector:"html:not(.acc-menu, .acc-widget)"},"high-saturation":{styles:{filter:"saturate(200%)"},selector:"html:not(.acc-menu, .acc-widget)"}},this.translations={en:{"Accessibility Menu":"Accessibility Menu","Reset settings":"Reset settings","Reset All Settings":"Reset All Settings",Close:"Close","Content Adjustments":"Content Adjustments","Adjust Font Size":"Adjust Font Size","Highlight Title":"Highlight Title","Highlight Links":"Highlight Links","Readable Font":"Readable Font","Color Adjustments":"Color Adjustments","Invert Colors":"Invert Colors","Light Contrast":"Light Contrast","Dark Contrast":"Dark Contrast","High Contrast":"High Contrast","High Saturation":"High Saturation","Low Saturation":"Low Saturation",Monochrome:"Monochrome",Tools:"Tools","Reading Guide":"Reading Guide","Stop Animations":"Stop Animations","Big Cursor":"Big Cursor","Increase Font Size":"Increase Font Size","Decrease Font Size":"Decrease Font Size","Letter Spacing":"Letter Spacing","Line Height":"Line Height","Font Weight":"Font Weight","Dyslexia Font":"Dyslexia Font",Language:"Language","Open Accessibility Menu":"Open Accessibility Menu","Hide Images":"Hide Images"}},this.supportedLanguages=[{code:"en",label:"English (English)"}],this.accessTools=[{label:"Big Cursor",key:"large-pointer",icon:this.widgetIcons.largePointer},{label:"Stop Animations",key:"pause-motion",icon:this.widgetIcons.pauseMotion},{label:"Reading Guide",key:"reading-aid",icon:this.widgetIcons.readingAid}],this.textScaleIndex=0,this.textScaleValues=[1.2,1.4,1.6],this.contentOptions=[{label:"Font Weight",key:"bold-text",icon:this.widgetIcons.boldText},{label:"Line Height",key:"line-spacing",icon:this.widgetIcons.lineSpacing},{label:"Letter Spacing",key:"letter-spacing",icon:this.widgetIcons.letterSpacing},{label:"Hide Images",key:"hide-images",icon:this.widgetIcons.hideImages},{label:"Dyslexia Font",key:"readable-text",icon:this.widgetIcons.dyslexiaFont},{label:"Highlight Links",key:"highlight-links",icon:this.widgetIcons.highlightLinks},{label:"Highlight Title",key:"highlight-title",icon:this.widgetIcons.highlightTitle},{label:"Font Size",key:"text-scale",icon:this.widgetIcons.adjustFontSize,multiLevel:!0,levels:this.textScaleValues.length}],this.multiLevelFeatures={"text-scale":{levels:this.textScaleValues.length,currentIndex:-1,values:this.textScaleValues}},this.readingAidTemplate=`
          <style>
            .acc-rg {
              position: fixed;
              left: 0;
              right: 0;
              width: 100%;
              pointer-events: none;
              background-color: rgba(0, 0, 0, 0.6);
              z-index: ${this.widgetTheme.zIndex+1};
            }
            .acc-rg-top {
              top: 0;
            }
            .acc-rg-bottom {
              bottom: 0;
            }
          </style>
          <div class="acc-rg acc-rg-top" role="presentation"> </div>
          <div class="acc-rg acc-rg-bottom" role="presentation"> </div>
        `,this.colorOptions=[{label:"Dark Contrast",key:"dark-contrast",icon:this.widgetIcons.darkContrast},{label:"Light Contrast",key:"light-contrast",icon:this.widgetIcons.lightContrast},{label:"Invert Colors",key:"invert-colors",icon:this.widgetIcons.invertColors},{label:"Low Saturation",key:"low-saturation",icon:this.widgetIcons.lowSaturation},{label:"Monochrome",key:"monochrome",icon:this.widgetIcons.monochrome},{label:"High Saturation",key:"high-saturation",icon:this.widgetIcons.highSaturation}],this.widgetConfig={},this.cookieKey="accweb",this.readingAidVisible=!1,this.textElementsCache=null,this.options=Object.assign({lang:"en",position:"bottom-left"},t)}storageAvailable(){try{let t="__test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(e){return!1}}fetchCookie(t){let e=t+"=";try{let i=decodeURIComponent(document.cookie);return i.split(";").map(t=>t.trim()).find(t=>t.startsWith(e))?.substring(e.length)||"{}"}catch(a){return console.warn("Error reading cookie:",a),"{}"}}storeCookie(t,e,i){try{let a=new Date;a.setTime(a.getTime()+864e5*i);let c="expires="+a.toUTCString(),o="https:"===window.location.protocol;document.cookie=t+"="+e+";"+c+";path=/;SameSite=Strict"+(o?";Secure":"")}catch(r){console.warn("Error setting cookie:",r)}}findElement(t,e=document){try{return e.querySelector(t)}catch(i){return console.warn(`Failed to query selector: ${t}`,i),null}}injectStyle(t,e){if(e)try{let i=document.getElementById(t)||document.createElement("style");i.innerHTML=e,i.id||(i.id=t,document.head.appendChild(i))}catch(a){console.warn("Error adding stylesheet:",a)}}createCSS(t){let e="";if(!t)return e;let i=["-o-","-ms-","-moz-","-webkit-",""],a=["filter"];for(let c in t){if(t.hasOwnProperty(c))(a.includes(c)?i:[""]).forEach(i=>{e+=`${i}${c}:${t[c]} !important;`})}return e}wrapCSS(t,e,i){let a="";return e.forEach(e=>{a+=`${t} ${e}{${i}}`}),a}buildCSS(t){if(!t)return"";let e="";return(e+=this.createCSS(t.styles||{})).length&&t.selector&&(e=this.wrapCSS(t.selector,t.childrenSelector||[""],e)),e+=t.css||""}applyToolStyle(t){let{id:e="",enable:i=!1}=t,a=`acc-${e}`;if(i){let c=this.buildCSS(t);this.injectStyle(a,c)}else{let o=document.getElementById(a);o&&o.remove()}document.documentElement.classList.toggle(a,i)}toggleDisplay(t,e){if(t)try{t.style.display=void 0===e?"none"===t.style.display?"block":"none":e?"block":"none"}catch(i){console.warn("Error toggling element:",i)}}updateState(t){let e={...this.widgetConfig,states:{...this.widgetConfig.states,...t}};return this.saveConfig(e),e}saveConfig(t){if(this.widgetConfig={...this.widgetConfig,...t},this.storageAvailable())try{localStorage.setItem(this.cookieKey,JSON.stringify(this.widgetConfig))}catch(e){this.storeCookie(this.cookieKey,JSON.stringify(this.widgetConfig),365)}else this.storeCookie(this.cookieKey,JSON.stringify(this.widgetConfig),365)}retrieveState(t){return this.widgetConfig.states?this.widgetConfig.states[t]:void 0}loadConfig(t=!0){if(t)return this.widgetConfig;let e=this.fetchSavedConfig();if(e)try{this.widgetConfig=JSON.parse(e)}catch(i){console.warn("Error parsing config:",i),this.widgetConfig={}}return this.widgetConfig}fetchSavedConfig(){if(this.storageAvailable())try{let t=localStorage.getItem(this.cookieKey);if(t)return t}catch(e){console.warn("localStorage failed, falling back to cookies:",e)}let i=this.fetchCookie(this.cookieKey);return i&&""!==i?i:"{}"}translate(t){let{lang:e}=this.loadConfig(),i=this.translations[e]||this.translations.en;return i[t]||t}throttle(t,e){let i;return function(...a){i||(t.apply(this,a),i=!0,setTimeout(()=>i=!1,e))}}scaleText(t=1){try{this.textElementsCache||(this.textElementsCache=document.querySelectorAll("h1,h2,h3,h4,h5,h6,p,a,dl,dt,li,ol,th,td,span,blockquote,.acc-text")),this.textElementsCache.forEach(e=>{if(!e.classList.contains("material-icons")&&!e.classList.contains("fa")){let i=Number(e.getAttribute("data-acc-baseSize")||0);i||(i=parseInt(window.getComputedStyle(e).getPropertyValue("font-size")),e.setAttribute("data-acc-baseSize",String(i)));let a=i*t;e.style.fontSize=a+"px"}})}catch(e){console.warn("Error scaling text:",e)}}enableBoldText(t=!1){this.applyToolStyle({id:"bold-text",selector:"html",childrenSelector:["","*:not(.material-icons,.acc-menu,.acc-menu *, .acc-widget, .acc-widget *)"],styles:{"font-weight":"700"},enable:t})}adjustLetterSpacing(t=!1){this.applyToolStyle({id:"letter-spacing",selector:"html",childrenSelector:["","*:not(.material-icons,.acc-menu,.acc-menu *, .acc-widget, .acc-widget *)"],styles:{"letter-spacing":"2px"},enable:t})}adjustLineSpacing(t=!1){this.applyToolStyle({id:"line-spacing",selector:"html",childrenSelector:["","*:not(.material-icons,.acc-menu,.acc-menu *, .acc-widget, .acc-widget *)"],styles:{"line-height":"3"},enable:t})}enableLargePointer(t=!1){this.applyToolStyle({id:"large-pointer",selector:"body",childrenSelector:["*"],styles:{cursor:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='98px' height='98px' viewBox='0 0 48 48'%3E%3Cpath fill='%23E0E0E0' d='M27.8 39.7c-.1 0-.2 0-.4-.1s-.4-.3-.6-.5l-3.7-8.6-4.5 4.2c-.1.2-.3.3-.6.3-.1 0-.3 0-.4-.1-.3-.1-.6-.5-.6-.9V12c0-.4.2-.8.6-.9.1-.1.3-.1.4-.1.2 0 .5.1.7.3l16 15c.3.3.4.7.3 1.1-.1.4-.5.6-.9.7l-6.3.6 3.9 8.5c.1.2.1.5 0 .8-.1.2-.3.5-.5.6l-2.9 1.3c-.2-.2-.4-.2-.5-.2z'/%3E%3Cpath fill='%23212121' d='m18 12 16 15-7.7.7 4.5 9.8-2.9 1.3-4.3-9.9L18 34V12m0-2c-.3 0-.5.1-.8.2-.7.3-1.2 1-1.2 1.8v22c0 .8.5 1.5 1.2 1.8.3.2.6.2.8.2.5 0 1-.2 1.4-.5l3.4-3.2 3.1 7.3c.2.5.6.9 1.1 1.1.2.1.5.1.7.1.3 0 .5-.1.8-.2l2.9-1.3c.5-.2.9-.6 1.1-1.1.2-.5.2-1.1 0-1.5l-3.3-7.2 4.9-.4c.8-.1 1.5-.6 1.7-1.3.3-.7.1-1.6-.5-2.1l-16-15c-.3-.5-.8-.7-1.3-.7z'/%3E%3C/svg%3E\") 40 15, auto"},enable:t})}highlightLinks(t=!1){let e={id:"highlight-links",selector:"html",childrenSelector:["a[href]:not(.acc-menu a, .acc-widget a)","summary.header__menu-item:not(.acc-menu summary, .acc-widget summary)","summary.link:not(.acc-menu summary, .acc-widget summary)","summary[role='button']:not(.acc-menu summary, .acc-widget summary)","details > summary.list-menu__item:not(.acc-menu summary, .acc-widget summary)",".header__menu-item[role='button']:not(.acc-menu *, .acc-widget *)"],styles:{outline:`3px solid ${this.widgetTheme.primaryColor}`,"outline-offset":"2px"}};this.applyToolStyle({...e,enable:t})}highlightTitles(t=!1){let e={id:"highlight-title",selector:"html",childrenSelector:this.targetSelectors.HEADERS,styles:{outline:`3px solid ${this.widgetTheme.primaryColor}`,"outline-offset":"2px"}};this.applyToolStyle({...e,enable:t})}enableReadableText(t=!1){let e={id:"readable-text",selector:"body",childrenSelector:["*:not(.acc-widget):not(.acc-menu):not(.acc-container):not(.acc-container *)",...this.targetSelectors.TEXT.map(t=>`${t}:not(.acc-widget ${t}, .acc-menu ${t}, .acc-container ${t})`)],styles:{"font-family":"OpenDyslexic3, Comic Sans MS, Arial, Helvetica, sans-serif"},css:`@font-face {
        font-family: OpenDyslexic3;
        src: url("https://website-widgets.pages.dev/fonts/OpenDyslexic3-Regular.woff") format("woff"),
             url("https://website-widgets.pages.dev/fonts/OpenDyslexic3-Regular.ttf") format("truetype");
      }`};this.applyToolStyle({...e,enable:t})}pauseMotion(t=!1){this.applyToolStyle({id:"pause-motion",selector:"html",childrenSelector:["*"],styles:{transition:"none","animation-fill-mode":"forwards","animation-iteration-count":"1","animation-duration":".01s"},enable:t})}enableReadingAid(t=!1){try{let e=this.findElement(".acc-rg-container");if(t){if(!e){(e=document.createElement("div")).setAttribute("class","acc-rg-container"),e.setAttribute("aria-hidden","true"),e.innerHTML=this.readingAidTemplate,document.body.prepend(e);let i=e.querySelector(".acc-rg-top"),a=e.querySelector(".acc-rg-bottom");i.style.display="none",a.style.display="none",this.readingAidVisible=!1;let c=this.throttle(t=>{this.readingAidVisible||(i.style.display="block",a.style.display="block",this.readingAidVisible=!0);let e=t.clientY,c=Math.max(0,window.innerHeight-(e+50));i.style.height=`${Math.max(0,e-50)}px`,a.style.height=`${c}px`},16);window.__accweb__scrollGuide=c,document.addEventListener("mousemove",c,{passive:!0})}}else this.readingAidVisible=!1,e&&(e.remove(),window.__accweb__scrollGuide&&(document.removeEventListener("mousemove",window.__accweb__scrollGuide),delete window.__accweb__scrollGuide))}catch(o){console.warn("Error with reading aid:",o)}}concealImages(t=!1){let e="acc-hide-images",i=document.getElementById(e);if(i&&i.remove(),document.documentElement.classList.toggle(e,t),t){let a=`
      body > *:not(.acc-container) img,
      body > *:not(.acc-container) picture,
      body > *:not(.acc-container) svg:not(.acc-container svg),
      body > *:not(.acc-container) video,
      body > *:not(.acc-container) iframe,
      body > *:not(.acc-container) canvas,
      body > *:not(.acc-container) .video,
      body > *:not(.acc-container) .image {
        display: none !important;
      }
    `;this.injectStyle(e,a)}}concealImages(t=!1){let e="acc-hide-images",i=document.getElementById(e);if(i&&i.remove(),document.documentElement.classList.toggle(e,t),t){let a=`
        body > *:not(.acc-container) img,
        body > *:not(.acc-container) picture,
        body > *:not(.acc-container) svg:not(.acc-container svg),
        body > *:not(.acc-container) video,
        body > *:not(.acc-container) iframe,
        body > *:not(.acc-container) canvas,
        body > *:not(.acc-container) .video,
        body > *:not(.acc-container) .image {
          display: none !important;
        }
      `;this.injectStyle(e,a)}}applyEnhancements(){let{states:t}=this.loadConfig();if(t&&t["text-scale"]){let e=t["text-scale"],i=this.textScaleValues.indexOf(e);i>-1?(this.textScaleIndex=i,this.multiLevelFeatures["text-scale"].currentIndex=i,this.scaleText(e)):this.scaleText(1)}else this.multiLevelFeatures["text-scale"].currentIndex=-1,this.scaleText(1);this.concealImages(t&&t["hide-images"]),this.highlightTitles(t&&t["highlight-title"]),this.highlightLinks(t&&t["highlight-links"]),this.adjustLetterSpacing(t&&t["letter-spacing"]),this.adjustLineSpacing(t&&t["line-spacing"]),this.enableBoldText(t&&t["bold-text"]),this.enableReadableText(t&&t["readable-text"]),this.enableReadingAid(t&&t["reading-aid"]),this.pauseMotion(t&&t["pause-motion"]),this.enableLargePointer(t&&t["large-pointer"])}applyVisualFilters(){let{states:t}=this.loadConfig(),e="";if(["dark-contrast","light-contrast","invert-colors","low-saturation","monochrome","high-saturation"].forEach(i=>{if(t&&t[i]){let a=this.visualFilters[i];if(a){let c={...a,selector:a.selector||"body > *:not(.acc-container)"};e+=this.buildCSS(c)}}}),""===e.trim()){let i=document.getElementById("acc-filter-style");i&&i.remove()}else this.injectStyle("acc-filter-style",e)}cycleTextScale(t=!1){t?(this.textScaleIndex=(this.textScaleIndex+1)%this.textScaleValues.length,this.multiLevelFeatures["text-scale"]&&(this.multiLevelFeatures["text-scale"].currentIndex=this.textScaleIndex)):(this.textScaleIndex=0,this.multiLevelFeatures["text-scale"]&&(this.multiLevelFeatures["text-scale"].currentIndex=0));let e=document.querySelector('.acc-progress-indicator[data-feature="text-scale"]');if(e){let i=e.querySelectorAll(".acc-progress-dot");i.forEach(t=>t.classList.remove("active")),this.textScaleIndex<i.length&&i[this.textScaleIndex].classList.add("active")}let a=this.textScaleValues[this.textScaleIndex];return this.scaleText(a),this.updateState({"text-scale":a}),this.textScaleIndex}cycleMultiLevelFeature(t,e){let i=this.multiLevelFeatures[t],a=i.currentIndex+1;if(a>=i.levels)i.currentIndex=-1,e.classList.remove("acc-selected"),e.setAttribute("aria-pressed","false"),this.updateState({[t]:!1});else{i.currentIndex=a,e.classList.add("acc-selected"),e.setAttribute("aria-pressed","true");let c=i.values[a];this.updateState({[t]:c})}let o=e.querySelector(`.acc-progress-indicator[data-feature="${t}"]`);if(o){let r=o.querySelectorAll(".acc-progress-dot");r.forEach((t,e)=>{t.classList.toggle("active",e===i.currentIndex)})}if("text-scale"===t){let s=i.currentIndex>=0?i.values[i.currentIndex]:1;this.scaleText(s)}else this.applyVisualFilters()}resetEnhancements(){this.saveConfig({states:{}}),this.textScaleIndex=0,Object.keys(this.multiLevelFeatures).forEach(t=>{this.multiLevelFeatures[t].currentIndex=-1});let t=document.querySelectorAll(".acc-selected");t.forEach(t=>{t.classList.remove("acc-selected"),t.setAttribute("aria-pressed","false")});let e=document.querySelectorAll(".acc-progress-indicator");e.forEach(t=>{let e=t.querySelectorAll(".acc-progress-dot");e.forEach(t=>t.classList.remove("active"))}),document.activeElement&&document.activeElement.blur(),["acc-bold-text","acc-letter-spacing","acc-line-spacing","acc-large-pointer","acc-highlight-links","acc-highlight-title","acc-readable-text","acc-pause-motion","acc-hide-images","acc-filter-style"].forEach(t=>{let e=document.getElementById(t);e&&e.remove()}),document.documentElement.classList.remove("acc-filter","acc-saturation","acc-bold-text","acc-letter-spacing","acc-line-spacing","acc-large-pointer","acc-highlight-links","acc-highlight-title","acc-readable-text","acc-pause-motion","acc-hide-images"),this.textElementsCache&&this.textElementsCache.forEach(t=>{if(!t.classList.contains("material-icons")&&!t.classList.contains("fa")){let e=t.getAttribute("data-acc-baseSize");e?t.style.fontSize=`${e}px`:t.style.fontSize=""}});let i=this.findElement(".acc-rg-container");i&&(i.remove(),window.__accweb__scrollGuide&&(document.removeEventListener("mousemove",window.__accweb__scrollGuide),delete window.__accweb__scrollGuide))}renderOptions(t,e){let i="";for(let a=0;a<t.length;a++){let c=t[a],o=!0===c.multiLevel,r="";if(o){let s=this.multiLevelFeatures[c.key];if(s){r=`<div class="acc-progress-indicator" data-feature="${c.key}">`;for(let n=0;n<s.levels;n++){let l=s.currentIndex===n;r+=`<div class="acc-progress-dot${l?" active":""}" data-level="${n}"> </div>`}r+=" </div>"}}i+=`<button 
        class="acc-btn ${e||""} ${this.multiLevelFeatures[c.key]?.currentIndex>=0?"acc-selected":""}" 
        type="button" 
        data-key="${c.key}" 
        data-multi-level="${o}"
        title="${c.label}"
        aria-label="${c.label}"
        aria-pressed="${this.multiLevelFeatures[c.key]?.currentIndex>=0}"
        aria-controls="acc-menu-content">
          ${c.icon}
          <span class="acc-label">${c.label}</span>
          ${r}
        </button>`}return i}getTranslatedText(t,e){let i=t.getAttribute("data-acc-text");return!i&&e&&(i=e,t.setAttribute("data-acc-text",i)),this.translate(i)}translateMenuUI(t){t.querySelectorAll(".acc-section-title, .acc-label").forEach(t=>{t.innerText=this.getTranslatedText(t,t.innerText.trim())}),t.querySelectorAll("[title]").forEach(t=>{t.setAttribute("title",this.getTranslatedText(t,t.getAttribute("title")))}),t.querySelectorAll("[aria-label]").forEach(t=>{t.setAttribute("aria-label",this.getTranslatedText(t,t.getAttribute("aria-label")))})}displayMenu({container:t,lang:e}){try{let i=`
      <style>
        /* WCAG-friendly CSS Variables */
        :root {
          /* Core colors */
          --acc-primary-color: ${this.widgetTheme.primaryColor};
          --acc-primary-color-light: ${this.widgetTheme.primaryColorLight};
          --acc-primary-color-dark: ${this.widgetTheme.primaryColorDark};
          --acc-bg-color: ${this.widgetTheme.backgroundColor};
          --acc-text-color: ${this.widgetTheme.textColor};
          --acc-text-color-inverted: ${this.widgetTheme.textColorInverted};
          
          /* UI elements */
          --acc-card-bg: ${this.widgetTheme.cardBackground};
          --acc-border-color: ${this.widgetTheme.borderColor};
          --acc-focus-ring-color: ${this.widgetTheme.focusRingColor};
          
          /* Interactive states */
          --acc-hover-color: ${this.widgetTheme.hoverColor};
          --acc-active-color: ${this.widgetTheme.activeColor};
          
          /* Other UI properties */
          --acc-border-radius: ${this.widgetTheme.borderRadius};
          --acc-button-border-radius: ${this.widgetTheme.buttonBorderRadius};
          --acc-header-height: ${this.widgetTheme.headerHeight};
          --acc-focus-outline-width: ${this.widgetTheme.focusBorderWidth};
          --acc-focus-outline-offset: ${this.widgetTheme.focusOutlineOffset};
        }
        
        /* Base styles */
        .acc-menu {
          position: fixed;
          left: 0;
          top: 0;
          box-shadow: 0 0 8px rgba(0, 0, 0, 0.25);
          opacity: 1;
          transition: 0.3s;
          z-index: ${this.widgetTheme.zIndex};
          overflow: hidden;
          background: var(--acc-bg-color);
          width: 500px;
          line-height: 1.5;
          font-size: 16px;
          height: 100%;
          letter-spacing: 0.015em;
          color: var(--acc-text-color);
        }
        
        /* Ensure all elements inherit proper colors for accessibility */
        .acc-menu * {
          color: var(--acc-text-color);
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
          padding: 0;
          margin: 0;
          line-height: 1.5 !important;
          letter-spacing: normal !important;
        }
        
        /* Header section */
        .acc-menu-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding-left: 16px;
          padding-right: 16px;
          height: var(--acc-header-height);
          font-weight: 700 !important;
          background-color: var(--acc-primary-color) !important;
        }
        
        .acc-menu-title {
          font-size: 18px !important;
          color: var(--acc-text-color-inverted) !important;
          font-weight: bold;
        }

        .acc-header-back {
          display: flex;
          align-items: center;
        }

        .acc-back-btn {
          display: flex;
          align-items: center;
          gap: 8px;
          background: transparent;
          border: none;
          padding: 8px;
          cursor: pointer;
          font-size: 16px;
          font-weight: 600;
          color: var(--acc-text-color-inverted) !important;
          transition: background-color 0.2s;
          border-radius: 4px;
          visibility: hidden;
        }

        .acc-back-btn > span {
          color: var(--acc-text-color-inverted) !important;
        }

        .acc-back-btn.visible {
            visibility: visible;
          }

          .acc-back-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
          }

          .acc-back-btn:focus {
            outline: 2px solid var(--acc-text-color-inverted);
            outline-offset: 1px;
          }

          .acc-back-btn svg {
            fill: var(--acc-text-color-inverted) !important;
            width: 24px !important;
            height: 24px !important;
          }

          .acc-menu-title-dynamic {
            display: none !important;
          }

          .acc-menu-title-dynamic.visible {
            display: block !important;
          }

          .acc-menu-title-default {
            display: block !important;
          }

          .acc-menu-title-default.hidden {
            display: none !important;
          }
        
        .acc-menu-header svg {
          fill: var(--acc-text-color-inverted) !important;
          width: 28px !important;
          height: 28px !important;
          min-width: 28px !important;
          min-height: 28px !important;
          max-width: 28px !important;
          max-height: 28px !important;
        }
        
        .acc-menu-header > div {
          display: flex;
          align-items: center;
        }
        
        /* Interactive elements */
        .acc-menu-header div[role="button"] {
          cursor: pointer;
          padding: 8px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
        }
        
        .acc-menu-header div[role="button"]:hover {
          background-color: rgba(255, 255, 255, 0.2);
        }
        
        .acc-menu-header div[role="button"]:focus {
          outline: 2px solid var(--acc-text-color-inverted);
          outline-offset: 1px;
        }


        .acc-menu-header .acc-header-actions {
          display: flex;
          align-items: center;
          gap: 12px;
        }

        .acc-lang-toggle {
          cursor: pointer;
          background: transparent;
          border: none;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 4px;
          border-radius: 50%;
          color: var(--acc-text-color-inverted);
        }

        .acc-lang-toggle:hover {
          background-color: rgba(255, 255, 255, 0.2);
        }

        .acc-lang-toggle:focus {
          outline: 2px solid var(--acc-text-color-inverted);
          outline-offset: 1px;
        }

        .acc-lang-toggle svg {
          fill: var(--acc-text-color-inverted) !important;
          width: 28px !important;
          height: 28px !important;
        }

        .acc-lang-panel {
          position: absolute;
          top: var(--acc-header-height);
          right: 0;
          width: 100%;
          height: 100%;
          max-height: calc(100% - var(--acc-header-height)) !important;
          background: var(--acc-bg-color);
          z-index: 100;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
          overflow-y: auto;
          display: none;

        }

        .acc-lang-panel.open {
          display: block;
        }

        .acc-lang-current-container {
          padding: 16px;
        }

        .acc-lang-current {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          border: 2px solid var(--acc-primary-color);
          border-radius: var(--acc-button-border-radius);
          margin-top: 8px;
          color: var(--acc-primary-color);
          font-weight: 600;
          background: white;
        }

        .acc-lang-search-wrapper {
          padding: 0 16px 8px;
        }

        .acc-lang-search {
          width: 100%;
          padding: 10px 16px;
          border: 2px solid var(--acc-border-color);
          border-radius: var(--acc-button-border-radius);
          font-size: 16px;
          background-color: var(--acc-card-bg);
        }

        .acc-lang-search:focus {
          outline: var(--acc-focus-outline-width) solid var(--acc-focus-ring-color);
          outline-offset: var(--acc-focus-outline-offset);
          border-color: var(--acc-primary-color) !important;
        }

        .acc-lang-list {
          padding: 6px 16px 16px;
          max-height: 300px;
          overflow-y: auto;
        }

        .acc-lang-item {
          display: block;
          width: 100%;
          text-align: left;
          padding: 12px 16px;
          margin-bottom: 4px;
          background-color: transparent;
          border: none;
          border-radius: var(--acc-button-border-radius);
          cursor: pointer;
          font-size: 16px;
          color: var(--acc-text-color);
        }

        .acc-lang-item:hover {
          background-color: rgba(0, 0, 0, 0.05);
        }

        .acc-lang-item:focus {
          outline: var(--acc-focus-outline-width) solid var(--acc-focus-ring-color);
          outline-offset: var(--acc-focus-outline-offset);
        }

        .acc-lang-item.selected {
          background-color: rgba(0, 0, 0, 0.05);
          font-weight: 600;
        }

        .acc-icon-check {
          display: inline-block;
          width: 18px;
          height: 18px;
          background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%23886f60' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
          background-repeat: no-repeat;
          background-position: center;
        }


        
        /* Content sections */
        .acc-section {
          margin: 0 16px 24px;
        }
        
        .acc-section-title {
          font-size: 16px !important;
          padding: 16px 14px;
          font-weight: 600 !important;
          color: var(--acc-text-color);
        }
        
        .acc-menu .acc-lang-select {
          width: 100% !important;
          padding: 0 16px !important;
          font-size: 16px !important;
          font-family: inherit !important;
          font-weight: 600 !important;
          border-radius: var(--acc-button-border-radius) !important;
          background: var(--acc-card-bg) !important;
          border: 2px solid var(--acc-border-color) !important;
          min-height: 48px !important;
          max-height: 48px !important;
          height: 48px !important;
          color: var(--acc-text-color) !important;
          color: var(--acc-text-color) !important;
          -webkit-appearance: none !important;
          -moz-appearance: none !important;
          appearance: none !important;
          background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24px' viewBox='0%20-960%20960%20960' width='24px' fill='%231f1f1f'%3E%3Cpath d='M480-344%20240-584l56-56%20184 184%20184-184%2056 56-240 240Z'/%3E%3C/svg%3E") !important;
          background-repeat: no-repeat !important;
          background-position: right 12px center !important;
          background-size: 20px !important;
          padding-right: 44px !important;
        }
        
        /* Hide default arrows in Firefox and IE */
        .acc-menu .acc-lang-select::-ms-expand {
          display: none !important;
        }
        
        .acc-menu .acc-lang-select:focus {
          outline: var(--acc-focus-outline-width) solid var(--acc-focus-ring-color);
          outline-offset: var(--acc-focus-outline-offset);
          border-color: var(--acc-primary-color) !important;
        }
        
        /* Option grid layout */
        .acc-options {
          display: grid;
          grid-template-columns: repeat(3, minmax(0, 1fr));
          gap: 16px;
        }
        
        /* Button styling */
        .acc-btn {
          aspect-ratio: 6 / 5;
          border-radius: var(--acc-border-radius);
          padding: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          text-align: center;
          font-size: 16px !important;
          background: var(--acc-card-bg) !important;
          border: 2px solid var(--acc-border-color) !important;
          transition: all 0.2s ease;
          cursor: pointer;
          word-break: break-word;
          gap: 8px;
          position: relative;
        }
        
        .acc-btn:hover {
          border-color: var(--acc-hover-color) !important;
        }
        
        .acc-btn:focus {
          outline: var(--acc-focus-outline-width) solid var(--acc-focus-ring-color);
          outline-offset: var(--acc-focus-outline-offset);
          border-color: var(--acc-primary-color) !important;
        }
        
        .acc-btn .acc-label, .acc-text-adjust .acc-label div {
          font-size: 14px !important;
          font-weight: 600 !important;
        }
        
        /* SVG icons */
        .acc-text-adjust svg {
          width: 24px !important;
          height: 24px !important;
          min-width: 24px !important;
          min-height: 24px !important;
          max-width: 24px !important;
          max-height: 24px !important;
        }
        
        .acc-btn svg {
          width: 34px !important;
          height: 34px !important;
          min-width: 34px !important;
          min-height: 34px !important;
          max-width: 34px !important;
          max-height: 34px !important;
          fill: var(--acc-text-color);
        }
        
        /* Selected state */
        .acc-btn.acc-selected {
          background-color: var(--acc-primary-color) !important;
          border-color: var(--acc-primary-color) !important;
        }
        
        .acc-btn.acc-selected .acc-progress-dot {
          background-color: rgba(255, 255, 255, 0.5);
        }
        
        .acc-btn.acc-selected .acc-progress-dot.active {
          background-color: var(--acc-text-color-inverted) !important;
        }
        
        .acc-btn.acc-selected svg, 
        .acc-btn.acc-selected span,
        .acc-btn.acc-selected .acc-label {
          fill: var(--acc-text-color-inverted) !important;
          color: var(--acc-text-color-inverted) !important;
        }
        
        /* Reset All Settings button */

        .acc-reset-container {
          margin: 24px 16px;
          display: flex;
          justify-content: center;
        }

        .acc-reset-btn {
          display: flex;
          width: 100%;
          align-items: center;
          justify-content: center;
          text-align: center;
          padding: 12px 24px;
          background-color: var(--acc-primary-color) !important;
          border: none;
          border-radius: var(--acc-button-border-radius);
          font-weight: 600 !important;
          font-size: 16px !important;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .acc-reset-btn > span {
          color: var(--acc-text-color-inverted) !important;
        }

        .acc-reset-btn:hover {
          background-color: var(--acc-primary-color-dark) !important;
        }

        .acc-reset-btn:focus {
          outline: var(--acc-focus-outline-width) solid var(--acc-focus-ring-color);
          outline-offset: var(--acc-focus-outline-offset);
        }

        .acc-reset-btn svg {
          fill: var(--acc-text-color-inverted) !important;
          width: 24px !important;
          height: 24px !important;
          margin-right: 8px;
        }
        
        /* Footer section */
        .acc-footer {
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          background: var(--acc-card-bg);
          padding: 16px;
          text-align: center;
          border-top: 1px solid var(--acc-border-color);
          z-index: 100;
        }
        
        .acc-footer a {
          font-size: 14px !important;
          text-decoration: none !important;
          color: var(--acc-text-color) !important;
          background: transparent !important;
          font-weight: 600 !important;
          padding: 8px;
          border-radius: 4px;
        }
        
        .acc-footer a:hover {
          text-decoration: underline !important;
          color: var(--acc-primary-color) !important;
        }
        
        .acc-footer a:focus {
          outline: var(--acc-focus-outline-width) solid var(--acc-focus-ring-color);
          outline-offset: var(--acc-focus-outline-offset);
        }
        
        /* Content area */
        .acc-menu-content {
          overflow: auto;
          max-height: calc(100% - 80px);
          padding: 24px 0 36px;
        }
        
        /* Text adjustments */
        .acc-text-adjust {
          background: var(--acc-card-bg);
          padding: 20px;
          margin-bottom: 20px;
          border-radius: var(--acc-border-radius);
          border: 2px solid var(--acc-border-color);
        }
        
        .acc-text-adjust .acc-label {
          display: flex;
          justify-content: flex-start;
        }
        
        .acc-text-adjust > div {
          display: flex;
          justify-content: space-between;
          margin-top: 20px;
          align-items: center;
          font-size: 16px;
        }
        
        .acc-text-adjust .acc-label div {
          font-size: 16px !important;
        }
        
        .acc-text-adjust div[role="button"] {
          background: var(--acc-bg-color) !important;
          border-radius: 50%;
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          border: 2px solid var(--acc-border-color);
        }
        
        .acc-text-adjust div[role="button"]:hover {
          border-color: var(--acc-hover-color);
        }
        
        .acc-text-adjust div[role="button"]:focus {
          outline: var(--acc-focus-outline-width) solid var(--acc-focus-ring-color);
          outline-offset: var(--acc-focus-outline-offset);
        }
        
        /* Overlay */
        .acc-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: ${parseInt(this.widgetTheme.zIndex)-1};
        }
        
        /* Progress indicator */
        .acc-progress-indicator {
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 4px;
          margin-top: 8px;
          height: 8px;
        }
        
        .acc-progress-dot {
          width: 8px;
          height: 8px;
          border-radius: 50%;
          background-color: var(--acc-border-color);
          transition: background-color 0.2s ease;
        }
        
        .acc-progress-dot.active {
          background-color: var(--acc-primary-color);
        }
        
        /* Selected state updates indicator colors */
        .acc-btn.acc-selected .acc-progress-dot.active {
          background-color: var(--acc-bg-color);
        }
        
        /* Responsive adjustments */
        @media only screen and (max-width: 560px) {
          .acc-menu { width: 100%; }
        }
        
        @media only screen and (max-width: 420px) {
          .acc-options { 
            grid-template-columns: repeat(2, minmax(0, 1fr)); 
            gap: 12px; 
          }
          .acc-btn {
            padding: 8px;
          }
        }
        
        /* Ensure proper focus visibility for assistive technology */
        @media (prefers-reduced-motion: reduce) {
          .acc-menu,
          .acc-btn,
          .acc-lang-select,
          .acc-progress-dot,
          .acc-menu-header div[role="button"],
          .acc-reset-btn {
            transition: none;
          }
        }
      </style>
      <div class="acc-menu" role="dialog" aria-labelledby="accessibility-title">
        <div class="acc-menu-header">
          <div class="acc-header-back">
            <button type="button" class="acc-back-btn" aria-label="Back to accessibility menu">
              ${this.widgetIcons.arrowBack}
              <span>Back</span>
            </button>
          </div>
          <div id="accessibility-title" class="acc-menu-title acc-menu-title-default acc-label">Accessibility Menu</div>
          <div id="language-settings-title" class="acc-menu-title acc-menu-title-dynamic acc-label">Language Settings</div>
          <div class="acc-header-actions">
            <button type="button" class="acc-lang-toggle" aria-expanded="false" aria-label="Language settings" title="Language settings">
              ${this.widgetIcons.language}
            </button>
            <div role="button" class="acc-menu-close" title="Close" aria-label="Close accessibility menu" tabindex="0">
              ${this.widgetIcons.close}
            </div>
          </div>
        </div>
        <div id="acc-lang-panel" class="acc-lang-panel">
          <div class="acc-lang-current-container">
            <div class="acc-lang-current">
              <span id="acc-current-language">${this.supportedLanguages.find(t=>t.code===(e||"en"))?.label||"English (English)"}</span>
              <span class="acc-icon-check"></span>
            </div>
          </div>
          <div>
            <div class="acc-section-title">All Languages</div>
            <div class="acc-lang-search-wrapper">
              <input type="text" id="acc-lang-search" class="acc-lang-search" placeholder="Search language" aria-label="Search language">
            </div>
            <div class="acc-lang-list">
              ${this.supportedLanguages.map(t=>`<button type="button" class="acc-lang-item${t.code===(e||"en")?" selected":""}" data-lang="${t.code}">${t.label}</button>`).join("")}
            </div>
          </div>
          </div>
        <div id="acc-menu-content" class="acc-menu-content">
          <div class="acc-section">
            <div class="acc-section-title">Content Adjustments</div>
            <div class="acc-options content"> </div>
          </div>
          <div class="acc-section">
            <div class="acc-section-title">Color Adjustments</div>
            <div class="acc-options filters"> </div>
          </div>
          <div class="acc-section">
            <div class="acc-section-title">Tools</div>
            <div class="acc-options tools"> </div>
          </div>
          <div class="acc-reset-container">
            <button class="acc-reset-btn" title="Reset All Settings" aria-label="Reset all accessibility settings" tabindex="0">
              ${this.widgetIcons.reset}
              <span>Reset All Settings</span>
            </button>
          </div>
        </div>
        <div class="acc-footer">
          <a href="https://accessibleweb.com" target="_blank" rel="noopener noreferrer">AccessibleWeb Widget</a>
        </div>
      </div>
      <div class="acc-overlay"> </div>
      `,a=document.createElement("div");a.innerHTML=i;let c=this.findElement(".acc-menu",a);"right"===this.widgetTheme.menuPosition?(c.style.right="0px",c.style.left="auto"):(c.style.left="0px",c.style.right="auto"),c.querySelector(".content").innerHTML=this.renderOptions(this.contentOptions),c.querySelector(".tools").innerHTML=this.renderOptions(this.accessTools,"acc-tools"),c.querySelector(".filters").innerHTML=this.renderOptions(this.colorOptions,"acc-filter");let o=this.findElement(".acc-lang-toggle",c),r=this.findElement("#acc-lang-panel",c),s=this.findElement("#acc-lang-search",c),n=c.querySelectorAll(".acc-lang-item"),l=this.findElement(".acc-back-btn",c),$=this.findElement(".acc-menu-title-default",c),d=this.findElement(".acc-menu-title-dynamic",c);o.addEventListener("click",()=>{let t="true"===o.getAttribute("aria-expanded");o.setAttribute("aria-expanded",!t),r.classList.toggle("open"),l.classList.toggle("visible",!t),$.classList.toggle("hidden",!t),d.classList.toggle("visible",!t),t||s.focus()}),l.addEventListener("click",()=>{r.classList.remove("open"),o.setAttribute("aria-expanded","false"),l.classList.remove("visible"),$.classList.remove("hidden"),d.classList.remove("visible")}),document.addEventListener("click",t=>{!r.classList.contains("open")||r.contains(t.target)||o.contains(t.target)||l.contains(t.target)||(r.classList.remove("open"),o.setAttribute("aria-expanded","false"),l.classList.remove("visible"),$.classList.remove("hidden"),d.classList.remove("visible"))}),s.addEventListener("input",()=>{let t=s.value.toLowerCase();n.forEach(e=>{let i=e.textContent.toLowerCase();e.style.display=i.includes(t)?"block":"none"})}),n.forEach(t=>{t.addEventListener("click",()=>{let e=t.getAttribute("data-lang"),i=t.textContent;n.forEach(t=>t.classList.remove("selected")),t.classList.add("selected");let s=this.findElement("#acc-current-language",c);s&&(s.textContent=i),r.classList.remove("open"),o.setAttribute("aria-expanded","false"),this.saveConfig({lang:e}),this.translateMenuUI(a)})}),c.addEventListener("click",t=>{let e=t.target.closest('[role="button"], button, .acc-overlay');if(!e)return;if(e.classList.contains("acc-overlay")||e.classList.contains("acc-menu-close")){this.toggleDisplay(a,!1);return}if(e.classList.contains("acc-reset-btn")){this.resetEnhancements();return}let i=e.classList.contains("acc-btn")?e:null;if(i){let o=i.dataset.key;if("text-scale"===o)this.cycleMultiLevelFeature(o,i);else if(["dark-contrast","light-contrast","invert-colors","low-saturation","monochrome","high-saturation"].includes(o)){c.querySelectorAll(".acc-btn").forEach(t=>{let e=t.dataset.key;["dark-contrast","light-contrast","invert-colors","low-saturation","monochrome","high-saturation"].includes(e)&&e!==o&&(t.classList.remove("acc-selected"),t.setAttribute("aria-pressed","false"),this.updateState({[e]:!1}))});let r=!i.classList.contains("acc-selected");r?(i.classList.add("acc-selected"),i.setAttribute("aria-pressed","true"),this.updateState({[o]:o})):(i.classList.remove("acc-selected"),i.setAttribute("aria-pressed","false"),this.updateState({[o]:!1})),this.applyVisualFilters()}else{let s=!i.classList.contains("acc-selected");i.classList.toggle("acc-selected",s),i.setAttribute("aria-pressed",s),this.updateState({[o]:s}),this.applyEnhancements()}}}),c.querySelectorAll('[role="button"], button').forEach(t=>{t.addEventListener("keydown",e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),t.click())})}),this.translateMenuUI(a);let h=this.loadConfig();if(h.states){for(let g in h.states)if(h.states[g]&&"text-scale"!==g){let _=g,p=this.findElement(`.acc-btn[data-key="${_}"]`,c);p&&(p.classList.add("acc-selected"),p.setAttribute("aria-pressed","true"))}else if("text-scale"===g){let u=this.findElement('.acc-btn[data-key="text-scale"]',c);u&&this.textScaleIndex>0&&(u.classList.add("acc-selected"),u.setAttribute("aria-pressed","true"))}}return t.appendChild(a),a}catch(m){return console.error("Error displaying menu:",m),null}}displayWidget(t){try{let e=`
      <style>
        /* Base styles for the widget */
        .acc-widget, .acc-menu {
          -webkit-user-select: none;
          -moz-user-select: none;
          -ms-user-select: none;
          user-select: none;
          font-weight: 400;
          -webkit-font-smoothing: antialiased;
        }
        
        .acc-widget *, .acc-menu * { 
          box-sizing: border-box !important; 
        }
        
        /* Accessibility toggle button */
        .acc-toggle-btn {
          position: fixed;
          z-index: ${this.widgetTheme.zIndex};
          left: 30px;
          bottom: 30px;
          border-radius: 50%;
          align-items: center;
          justify-content: center;
          width: ${this.widgetTheme.buttonSize};
          height: ${this.widgetTheme.buttonSize};
          display: flex;
          cursor: pointer;
          outline: 4px solid ${this.widgetTheme.primaryColor} !important;
          border: 3px solid white !important;
          box-shadow: 0 2px 5px rgba(0,0,0,0.2) !important;
          background: ${this.widgetTheme.primaryColor} !important;
          transition: transform 0.2s ease;
        }
        
        .acc-toggle-btn svg {
          width: 28px;
          height: 28px;
          fill: white;
        }
        
        .acc-toggle-btn:hover {
          transform: scale(1.04);
        }

        .acc-toggle-btn:focus {
          outline: 3px solid ${this.widgetTheme.primaryColor} !important;
          outline-offset: 2px;

      }
        
        @media (prefers-reduced-motion: reduce) {
          .acc-toggle-btn {
            transition: none;
          }
        }
      </style>
      <div class="acc-widget">
        <a href="#" id="accessibilityWidget" class="acc-toggle-btn" title="Open Accessibility Menu" role="button" aria-label="Open accessibility menu" aria-expanded="false">
          ${this.widgetIcons.accessibility}
        </a>
      </div>
      `,i=document.createElement("div");i.innerHTML=e,i.classList.add("acc-container");let a=this.findElement(".acc-toggle-btn",i),{position:c="bottom-left",offset:o=[20,20]}=t,r=Array.isArray(o)?o:[20,20],s=r[0]||20,n=r[1]||25,l={left:`${s}px`,bottom:`${n}px`};"bottom-right"===c?l={right:`${s}px`,left:"auto",bottom:`${n}px`}:"top-left"===c?l={top:`${n}px`,bottom:"auto",left:`${s}px`}:"top-right"===c?l={top:`${n}px`,right:`${s}px`,bottom:"auto",left:"auto"}:"center-left"===c&&(l={top:"50%",transform:"translateY(-50%)",left:`${s}px`,bottom:"auto"}),Object.assign(a.style,l);let $;return a.addEventListener("click",e=>{e.preventDefault();let c="true"===a.getAttribute("aria-expanded");if(a.setAttribute("aria-expanded",!c),$)this.toggleDisplay($);else{$=this.displayMenu({...t,container:i});let o=$.querySelector(".acc-overlay");o&&o.addEventListener("click",()=>{a.blur()});let r=$.querySelector(".acc-menu-close");r&&r.addEventListener("click",()=>{a.blur()})}}),a.addEventListener("keydown",t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),a.click())}),document.body.appendChild(i),this.translateMenuUI(i),document.addEventListener("click",t=>{!a||t.target===a||a.contains(t.target)||$&&$.contains(t.target)||a.blur()}),i}catch(d){return console.error("Error displaying widget:",d),null}}fetchDataAttr(t){try{let e=`data-acc-${t}`,i=document.querySelector(`[${e}]`);return i?i.getAttribute(e):null}catch(a){return console.warn(`Error getting data attribute: ${t}`,a),null}}startAccessibleWebWidget(){try{let t=this.fetchDataAttr("lang")||document.querySelector("html")?.getAttribute("lang")?.replace(/[_-].*/,"")||navigator.language||"en";this.loadConfig(!1),this.applyEnhancements(),this.applyVisualFilters(),this.launchWidget({lang:t,position:"bottom-left"})}catch(e){console.error("Error starting AccessibleWeb Widget:",e)}}launchWidget(t={}){try{let e={lang:"en",position:"bottom-left"};try{let i=this.fetchSavedConfig();i&&(e={...e,...JSON.parse(i)})}catch(a){console.warn("Error loading saved config:",a)}e={...e,...t},this.saveConfig(e),this.displayWidget(e)}catch(c){console.error("Error in widget launch:",c)}}}const widgetInstance=new AccessibleWebWidget;"complete"===document.readyState||"interactive"===document.readyState?widgetInstance.startAccessibleWebWidget():document.addEventListener("DOMContentLoaded",()=>widgetInstance.startAccessibleWebWidget());